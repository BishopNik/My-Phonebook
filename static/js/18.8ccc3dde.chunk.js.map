{"version":3,"file":"static/js/18.8ccc3dde.chunk.js","mappings":"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","sources":["pages/ChangeSettings.jsx"],"sourcesContent":["/** @format */\n\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { Container } from 'styled/shared.styled';\nimport { changeAvatar, changeName, changePassword } from 'redux/auth/operations';\nimport { toastError, toastInfo } from 'components/Helpers';\nimport { useNavigate } from 'react-router-dom';\nimport {\n\tButton,\n\tButtonBox,\n\tForm,\n\tInput,\n\tFlexBoxMain,\n\tFlexBoxSection,\n\tFlexBox,\n\tImg,\n\tLabel,\n} from 'styled/shared.styled';\nimport { useAuth } from 'hooks';\n\nconst ChangeAvatar = () => {\n\tconst [avatar, setAvatar] = useState(null);\n\tconst [avatarURL, setAvatarURL] = useState(null);\n\tconst dispatch = useDispatch();\n\tconst navigate = useNavigate();\n\tconst { user } = useAuth();\n\n\tuseEffect(() => {\n\t\tif (avatar) {\n\t\t\tconst avatarObjectURL = URL.createObjectURL(avatar);\n\t\t\tsetAvatarURL(avatarObjectURL);\n\n\t\t\treturn () => URL.revokeObjectURL(avatarObjectURL);\n\t\t}\n\t}, [avatar]);\n\n\tconst newPassword = (oldPas, newPas, confPas) => {\n\t\tif (newPas !== confPas) {\n\t\t\ttoastError('Passwords do not match. Please change your password.');\n\t\t\treturn oldPas;\n\t\t}\n\t\treturn newPas;\n\t};\n\n\tconst handleSubmit = async e => {\n\t\te.preventDefault();\n\t\ttry {\n\t\t\tconst newName = e.target.name.value;\n\t\t\tconst oldPas = e.target.oldpassword.value;\n\t\t\tconst newPas = e.target.password.value;\n\t\t\tconst confPas = e.target.confirmpassword.value;\n\t\t\tconst resultPas = newPassword(oldPas, newPas, confPas);\n\n\t\t\tif (newName) {\n\t\t\t\tawait dispatch(changeName({ name: newName }));\n\t\t\t\ttoastInfo('Name changed');\n\t\t\t}\n\t\t\tif (resultPas !== oldPas) {\n\t\t\t\tawait dispatch(\n\t\t\t\t\tchangePassword({\n\t\t\t\t\t\toldPassword: oldPas,\n\t\t\t\t\t\tnewPassword: resultPas,\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\ttoastInfo('Password changed');\n\t\t\t}\n\t\t\tif (avatar) {\n\t\t\t\tconst formData = new FormData();\n\t\t\t\tformData.append('avatar', avatar, avatar.name);\n\t\t\t\tawait dispatch(changeAvatar(formData));\n\t\t\t\ttoastInfo('Avatar changed');\n\t\t\t}\n\t\t\tif (resultPas !== oldPas && oldPas !== null) navigate('/phonebook');\n\t\t} catch (error) {\n\t\t\ttoastError('Error change settings', error);\n\t\t}\n\t};\n\n\tconst handleFileChange = ({ target }) => {\n\t\tif (!target.files) {\n\t\t\ttoastError('Please select image');\n\t\t\treturn;\n\t\t}\n\t\tconst file = target.files[0];\n\t\tif (file && file instanceof File && file.type.startsWith('image/')) {\n\t\t\tsetAvatar(file);\n\t\t} else {\n\t\t\ttoastError('Bad type file');\n\t\t\ttarget.value = '';\n\t\t\tsetAvatarURL(user.avatarURL);\n\t\t\tsetAvatar(null);\n\t\t\ttarget.click();\n\t\t}\n\t};\n\n\treturn (\n\t\t<Container>\n\t\t\t<Form onSubmit={handleSubmit}>\n\t\t\t\t<FlexBoxMain>\n\t\t\t\t\t<FlexBoxSection>\n\t\t\t\t\t\t<FlexBox>\n\t\t\t\t\t\t\t<Label>\n\t\t\t\t\t\t\t\tOld name\n\t\t\t\t\t\t\t\t<Input type='text' name='oldname' value={user.name} disabled />\n\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t<Label>\n\t\t\t\t\t\t\t\tNew name\n\t\t\t\t\t\t\t\t<Input type='text' name='name' />\n\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t</FlexBox>\n\t\t\t\t\t\t<FlexBox>\n\t\t\t\t\t\t\t<Label>\n\t\t\t\t\t\t\t\tOld password\n\t\t\t\t\t\t\t\t<Input type='password' name='oldpassword' />\n\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t<Label>\n\t\t\t\t\t\t\t\tNew password\n\t\t\t\t\t\t\t\t<Input type='password' name='password' />\n\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t<Label>\n\t\t\t\t\t\t\t\tConfirm password\n\t\t\t\t\t\t\t\t<Input type='password' name='confirmpassword' />\n\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t</FlexBox>\n\t\t\t\t\t</FlexBoxSection>\n\t\t\t\t\t<FlexBoxSection>\n\t\t\t\t\t\t<Img src={avatarURL || user.avatarURL} alt='user avatar' />\n\t\t\t\t\t\t<Input type='file' name='avatar' onChange={handleFileChange} />\n\t\t\t\t\t\t<ButtonBox>\n\t\t\t\t\t\t\t<Button type='submit'>Change</Button>\n\t\t\t\t\t\t\t<Button type='button' onClick={() => navigate('/phonebook')}>\n\t\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</ButtonBox>\n\t\t\t\t\t</FlexBoxSection>\n\t\t\t\t</FlexBoxMain>\n\t\t\t</Form>\n\t\t</Container>\n\t);\n};\n\nexport default ChangeAvatar;\n"],"names":["_useState","useState","_useState2","_slicedToArray","avatar","setAvatar","_useState3","_useState4","avatarURL","setAvatarURL","dispatch","useDispatch","navigate","useNavigate","user","useAuth","useEffect","avatarObjectURL","URL","createObjectURL","revokeObjectURL","newPassword","oldPas","newPas","confPas","toastError","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","newName","resultPas","formData","wrap","_context","prev","next","preventDefault","target","name","value","oldpassword","password","confirmpassword","changeName","toastInfo","changePassword","oldPassword","FormData","append","changeAvatar","t0","stop","_x","apply","arguments","_jsx","Container","children","Form","onSubmit","_jsxs","FlexBoxMain","FlexBoxSection","FlexBox","Label","Input","type","disabled","Img","src","alt","onChange","_ref2","files","file","File","startsWith","click","ButtonBox","Button","onClick"],"sourceRoot":""}